<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>JMBN Components</title>
<link href="https://fonts.googleapis.com/css2?family=Play:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#000;--panel:#0b0b0b;--border:#d6b44c;--card:#141414;
  --accent:#f2d675;--text:#f7f1d0;--muted:#c9b06a;--bad:#ff6b6b;
  --fs-base:14px;--fs-small:11px;--fs-table:13px;--fs-h1:clamp(18px,2.2vw,22px);--fs-h2:clamp(14px,1.6vw,16px)
}
*{box-sizing:border-box}
body{
  background:
    radial-gradient(1200px 900px at 15% -10%, rgba(242,214,117,.08), transparent 60%),
    radial-gradient(900px 700px at 120% 110%, rgba(214,180,76,.05), transparent 60%),
    #000;
  color:var(--text);font-family:'Play',sans-serif;margin:0;padding:14px;letter-spacing:.25px;font-size:var(--fs-base)
}

/* Header */
.brand{display:flex;align-items:center;gap:10px;margin:0 0 8px;border-bottom:1px solid var(--border);padding-bottom:6px}
.brand-logo{width:44px;height:44px;object-fit:contain;filter:drop-shadow(0 0 4px rgba(242,214,117,.25))}
.brand h1{font-weight:700;font-size:var(--fs-h1);color:var(--accent);margin:0}

/* Shiny pill nav */
.nav{display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin:6px 0 10px}
.nav-btn{
  --gold:#f2d675;--gold2:#e7c760;--ring:#d6b44c;
  position:relative;display:inline-flex;align-items:center;justify-content:center;
  padding:7px 14px;border:1px solid var(--ring);border-radius:999px;
  background:linear-gradient(180deg,#0c0c0c,#060606);
  color:var(--accent);text-decoration:none;font-weight:700;
  box-shadow:inset 0 0 0 1px rgba(214,180,76,.12);
  transition:transform .15s ease, box-shadow .2s ease, background .2s ease, color .2s ease;
}
.nav-btn:hover{transform:translateY(-1px);box-shadow:0 0 12px rgba(214,180,76,.25), inset 0 0 0 1px rgba(214,180,76,.18);background:linear-gradient(180deg,#1a1a1a,#0a0a0a)}
.nav-btn.active{
  color:#000;background:linear-gradient(180deg,var(--gold),var(--gold2));
  border-color:var(--ring);box-shadow:0 0 20px rgba(214,180,76,.45);
}
.nav-btn.active::after{
  content:"";position:absolute;inset:0;background:linear-gradient(120deg,rgba(255,255,255,0) 30%,rgba(255,255,255,.3) 50%,rgba(255,255,255,0) 70%);
  border-radius:inherit;transform:translateX(-120%);animation:shine 2.8s ease-in-out infinite;pointer-events:none;
}
@keyframes shine{0%{transform:translateX(-120%)}35%{transform:translateX(120%)}100%{transform:translateX(120%)}}

/* Layout + table */
.panel{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:12px;margin-top:8px;box-shadow:0 0 18px rgba(214,180,76,.22)}
.controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px}
button{padding:7px 11px;border-radius:10px;background:linear-gradient(180deg,#0c0c0c,#060606);color:var(--accent);border:1px solid var(--border);cursor:pointer;font-family:'Play';transition:.2s}
button:hover{background:var(--accent);color:#000}
.btn-primary{background:var(--accent);color:#000}
input,select{background:#0a0a0a;border:1px solid var(--border);border-radius:8px;padding:9px;color:var(--text);font-size:var(--fs-table);font-family:'Play'}

.kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin:10px 0}
.kpi-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px;text-align:center}
.kpi-card h3{margin:0;color:var(--muted);font-size:11px;text-transform:uppercase}
.kpi-card .val{font-weight:700;font-size:18px;color:var(--accent);margin-top:4px}

.form-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin:10px 0}
@media(max-width:980px){.form-grid{grid-template-columns:1fr 1fr}}
@media(max-width:640px){.form-grid{grid-template-columns:1fr}}

.tableWrap{border:1px solid var(--border);border-radius:12px;overflow:auto;max-height:70vh;margin-top:10px}
table{width:100%;border-collapse:collapse;font-size:var(--fs-table)}
th,td{border-bottom:1px solid rgba(214,180,76,.3);padding:8px;text-align:left}
th{color:var(--accent);background:#080808;font-weight:500;font-size:12px}
tr:nth-child(even){background:#111}
tr:hover{background:rgba(214,180,76,.08)}
.small{font-size:var(--fs-small);color:var(--muted)}
</style>
</head>
<body>
  <div class="brand">
    <img class="brand-logo" src="https://static.wixstatic.com/media/b6db55_17d1c3c1572f401b948fa21101b18467~mv2.png/v1/fill/w_66,h_66,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/0_New_JMBN_Logo_Gold.png" alt="JMBN">
    <h1>JMBN Components</h1>
  </div>

  <nav class="nav">
    <a class="nav-btn" href="index.html">Manifest</a>
    <a class="nav-btn" href="hangar.html">Hangar</a>
    <a class="nav-btn" href="components.html">Components</a>
    <a class="nav-btn" href="contracts.html">Contracts</a>
  </nav>

  <div class="panel">
    <div class="controls">
      <input id="search" placeholder="Search (name, mfr, notes)…">
      <select id="filterType"><option value="">All Types</option></select>
      <select id="filterClass"><option value="">All Classes</option></select>
      <select id="filterGrade"><option value="">All Grades</option></select>
      <select id="filterSize"><option value="">All Sizes</option></select>
      <button id="saveBtn">Save</button>
      <button id="resetBtn" style="border-color:var(--bad);color:var(--bad)">Reset (Factory)</button>
      <button id="exportJSON">Export JSON</button>
      <button id="exportCSV">Export CSV</button>
      <button class="btn-primary" id="importJSON">Import JSON</button>
    </div>

    <div class="kpis">
      <div class="kpi-card"><h3>Total Components</h3><div class="val" id="kpiCount">0</div></div>
      <div class="kpi-card"><h3>By Type</h3><div class="val small" id="kpiType">—</div></div>
      <div class="kpi-card"><h3>Last Saved</h3><div class="val" id="lastSaved">—</div></div>
    </div>

    <h2 style="color:var(--accent);font-size:var(--fs-h2);margin:8px 0 4px">Add / Edit Component</h2>
    <div class="form-grid">
      <input id="compName" placeholder="Name *">
      <select id="compType">
        <option>Quantum Drive</option><option>Shield Generator</option><option>Power Plant</option><option>Cooler</option>
        <option>Computer</option><option>Radar</option><option>Weapon Mount</option><option>Missile Rack</option>
      </select>
      <select id="compSize"><option>S1</option><option>S2</option><option>S3</option><option>S4</option><option>S5</option></select>
      <select id="compGrade"><option>Grade A</option><option>Grade B</option><option>Grade C</option><option>Grade D</option></select>
      <select id="compClass"><option>Civilian</option><option>Industrial</option><option>Stealth</option><option>Competition</option><option>Military</option></select>
      <input id="compManufacturer" placeholder="Manufacturer">
      <input id="compBuy" placeholder="Where to Buy">
      <input id="compNotes" placeholder="Notes">
      <button class="btn-primary" id="saveComponent">Save Component</button>
    </div>

    <div class="tableWrap">
      <table>
        <thead><tr><th>Name</th><th>Type</th><th>Size</th><th>Grade</th><th>Class</th><th>Manufacturer</th><th>Where to Buy</th><th>Notes</th><th>Actions</th></tr></thead>
        <tbody id="rows"></tbody>
      </table>
    </div>
  </div>

<script>
/* Active nav highlight */
(function(){
  const here=location.pathname.split('/').pop()||'index.html';
  document.querySelectorAll('.nav-btn').forEach(a=>{
    if(a.getAttribute('href')===here){a.classList.add('active');a.setAttribute('aria-current','page');}
  });
})();

/* Storage & helpers */
const STORE='jmbn-components';
const $=s=>document.querySelector(s);const $$=s=>Array.from(document.querySelectorAll(s));
const uid=()=> 'CMP-'+Math.random().toString(36).slice(2,8);
function esc(s=''){const d=document.createElement('div');d.textContent=s??'';return d.innerHTML;}
let components=[],editId=null;

/* Prefilled list: Grade A / high-tier you can buy at shops */
const defaults=[
  {"id":uid(),"name":"Atlas","type":"Quantum Drive","size":"S1","grade":"Grade A","class":"Civilian","manufacturer":"RSI","buy":"HUR-L5 – Galleria – Platinum Bay","notes":"Fast, efficient S1 drive"},
  {"id":uid(),"name":"Hemera","type":"Quantum Drive","size":"S2","grade":"Grade A","class":"Civilian","manufacturer":"RSI","buy":"CRU-L5 – Galleria – Platinum Bay; Orison – Cousin Crows","notes":"Balanced long-range S2 drive"},
  {"id":uid(),"name":"Torrid","type":"Quantum Drive","size":"S2","grade":"Grade A","class":"Competition","manufacturer":"Propulsic","buy":"Area18 – Astro Armada","notes":"Great accel for time-sensitive runs"},

  {"id":uid(),"name":"Palisade","type":"Shield Generator","size":"S1","grade":"Grade A","class":"Industrial","manufacturer":"Basilisk","buy":"CRU-L4 – Galleria – Platinum Bay; New Babbage – Omega Pro","notes":"Excellent small-tank durability"},
  {"id":uid(),"name":"FR-76","type":"Shield Generator","size":"S1","grade":"Grade A","class":"Military","manufacturer":"Gorgon","buy":"Hurston – Everus Harbor – Platinum Bay","notes":"Strong S1 military shield"},
  {"id":uid(),"name":"Shimmer","type":"Shield Generator","size":"S1","grade":"Grade A","class":"Stealth","manufacturer":"Gorgon","buy":"Everus Harbor – Platinum Bay","notes":"Lower sig for stealth fits"},

  {"id":uid(),"name":"Snowpack","type":"Cooler","size":"S2","grade":"Grade A","class":"Industrial","manufacturer":"Juno StarWerk","buy":"Area18 – Dumper’s Depot; New Babbage – Omega Pro","notes":"High capacity cooler"},
  {"id":uid(),"name":"AbsoluteZero","type":"Cooler","size":"S2","grade":"Grade A","class":"Competition","manufacturer":"Juno StarWerk","buy":"Area18 – Dumper’s Depot","notes":"Top performance cooler for S2"},

  {"id":uid(),"name":"IonBurst","type":"Power Plant","size":"S1","grade":"Grade A","class":"Civilian","manufacturer":"Lightning Power Ltd.","buy":"Area18 – Dumper’s Depot; HUR-L2 – Platinum Bay","notes":"Reliable compact power"},
  {"id":uid(),"name":"LuxCore","type":"Power Plant","size":"S2","grade":"Grade A","class":"Competition","manufacturer":"Lightning Power Ltd.","buy":"Orison – Cousin Crows","notes":"Great output for S2 builds"},
  {"id":uid(),"name":"DeltaMax","type":"Power Plant","size":"S1","grade":"Grade A","class":"Combat","manufacturer":"Lightning Power Ltd.","buy":"Area18 – Dumper’s Depot; HUR-L5 – Platinum Bay","notes":"Good combat-tier unit"}
];

/* Load / Save / Reset */
function load(){
  const raw=localStorage.getItem(STORE);
  components = raw ? JSON.parse(raw) : defaults.slice();
  render(); updateKPI(); populateFilters();
}
function save(){
  localStorage.setItem(STORE, JSON.stringify(components));
  const t=new Date().toLocaleString(); const el=$('#lastSaved'); if(el) el.textContent=t;
}
$('#saveBtn').onclick=save;
$('#resetBtn').onclick=()=>{
  if(!confirm('Reset to factory defaults?')) return;
  components = defaults.slice();
  save(); render(); populateFilters(); updateKPI();
};

/* Form helpers */
function getForm(){
  return {
    id: editId || uid(),
    name: $('#compName').value.trim(),
    type: $('#compType').value,
    size: $('#compSize').value,
    grade: $('#compGrade').value,
    class: $('#compClass').value,
    manufacturer: $('#compManufacturer').value.trim(),
    buy: $('#compBuy').value.trim(),
    notes: $('#compNotes').value.trim()
  };
}
function clearForm(){
  editId=null;
  ['compName','compManufacturer','compBuy','compNotes'].forEach(i=>$('#'+i).value='');
  ['compType','compSize','compGrade','compClass'].forEach(i=>$('#'+i).selectedIndex=0);
  $('#saveComponent').textContent='Save Component';
}
function fillForm(c){
  editId=c.id;
  $('#compName').value=c.name||'';
  $('#compType').value=c.type||'Quantum Drive';
  $('#compSize').value=c.size||'S1';
  $('#compGrade').value=c.grade||'Grade A';
  $('#compClass').value=c.class||'Civilian';
  $('#compManufacturer').value=c.manufacturer||'';
  $('#compBuy').value=c.buy||'';
  $('#compNotes').value=c.notes||'';
  $('#saveComponent').textContent='Update Component';
}
$('#saveComponent').onclick=()=>{
  const c=getForm();
  if(!c.name){ alert('Name is required'); return; }
  const i=components.findIndex(x=>x.id===c.id);
  if(i>=0) components[i]=c; else components.push(c);
  save(); render(); clearForm(); updateKPI();
};

/* Filters */
function distinct(arr,key){ return [...new Set(arr.map(x=>x[key]).filter(Boolean))].sort(); }
function fillSelect(sel,values){
  const prev=sel.value;
  sel.innerHTML='<option value="">All</option>'+values.map(v=>`<option>${esc(v)}</option>`).join('');
  if(values.includes(prev)) sel.value=prev;
}
function populateFilters(){
  fillSelect($('#filterType'), distinct(components,'type'));
  fillSelect($('#filterClass'), distinct(components,'class'));
  fillSelect($('#filterGrade'), distinct(components,'grade'));
  fillSelect($('#filterSize'), distinct(components,'size'));
}
['search','filterType','filterClass','filterGrade','filterSize'].forEach(id=>{
  const el=document.getElementById(id); el&&el.addEventListener('input',render);
});

/* Render */
function render(){
  const q=($('#search').value||'').toLowerCase().trim();
  const ft=$('#filterType').value, fc=$('#filterClass').value, fg=$('#filterGrade').value, fs=$('#filterSize').value;
  let arr=components.slice();
  if(q)  arr=arr.filter(c=>`${c.name} ${c.manufacturer} ${c.buy} ${c.notes}`.toLowerCase().includes(q));
  if(ft) arr=arr.filter(c=>c.type===ft);
  if(fc) arr=arr.filter(c=>c.class===fc);
  if(fg) arr=arr.filter(c=>c.grade===fg);
  if(fs) arr=arr.filter(c=>c.size===fs);

  $('#rows').innerHTML = arr.map(c=>`
    <tr>
      <td><b style="color:var(--accent)">${esc(c.name)}</b></td>
      <td>${esc(c.type||'')}</td>
      <td>${esc(c.size||'')}</td>
      <td>${esc(c.grade||'')}</td>
      <td>${esc(c.class||'')}</td>
      <td>${esc(c.manufacturer||'')}</td>
      <td>${esc(c.buy||'')}</td>
      <td>${esc(c.notes||'')}</td>
      <td style="white-space:nowrap">
        <button data-act="edit" data-id="${c.id}">Edit</button>
        <button data-act="del"  data-id="${c.id}" style="border-color:var(--bad);color:var(--bad)">Del</button>
      </td>
    </tr>`).join('');

  $$('#rows button[data-act]').forEach(b=>{
    const id=b.dataset.id;
    if(b.dataset.act==='edit') b.onclick=()=>{ const c=components.find(x=>x.id===id); if(c) fillForm(c); };
    if(b.dataset.act==='del')  b.onclick=()=>{ if(confirm('Delete this component?')){ components=components.filter(x=>x.id!==id); save(); render(); updateKPI(); } };
  });
}

/* KPIs */
function updateKPI(){
  $('#kpiCount').textContent = String(components.length);
  const byType={}; components.forEach(c=>{ byType[c.type]=(byType[c.type]||0)+1; });
  const top = Object.entries(byType).sort((a,b)=>b[1]-a[1]).slice(0,3).map(([k,v])=>`${k}: ${v}`).join(' • ') || '—';
  $('#kpiType').textContent = top;
}

/* Export / Import */
function exportJSON(){
  const blob=new Blob([JSON.stringify(components,null,2)],{type:'application/json'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='jmbn-components.json'; a.click();
  URL.revokeObjectURL(url);
}
function exportCSV(){
  const headers=['name','type','size','grade','class','manufacturer','buy','notes'];
  const rows=components.map(c=>headers.map(h=>String(c[h]??'')));
  const csv=[headers.join(','), ...rows.map(r=>'"'+r.map(s=>s.replace(/"/g,'""')).join('","')+'"')].join('\n');
  const blob=new Blob([csv],{type:'text/csv'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='jmbn-components.csv'; a.click();
  URL.revokeObjectURL(url);
}
$('#exportJSON').onclick=exportJSON;
$('#exportCSV').onclick=exportCSV;

function importJSON(){
  const inp=document.createElement('input'); inp.type='file'; inp.accept='application/json';
  inp.onchange=()=>{
    const f=inp.files?.[0]; if(!f) return;
    const r=new FileReader();
    r.onload=()=>{
      try{
        const arr=JSON.parse(r.result);
        if(!Array.isArray(arr)) throw new Error('Expected an array');
        arr.forEach(x=>{ if(!x.id) x.id=uid(); });
        if(confirm('Merge with existing? (Cancel = Replace)')){
          const map=new Map(components.map(x=>[x.id,x]));
          for(const x of arr){ map.set(x.id,x); }
          components=[...map.values()];
        }else{
          components=arr;
        }
        save(); render(); populateFilters(); updateKPI(); alert('Import complete.');
      }catch(e){ alert('Import failed: '+e.message); }
    };
    r.readAsText(f);
  };
  inp.click();
}
$('#importJSON').onclick=importJSON;

/* Init */
document.addEventListener('DOMContentLoaded', load);
</script>
</body>
</html>
