<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>JMBN — Login</title>
<link href="https://fonts.googleapis.com/css2?family=Play:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --border:#d6b44c;
    --accent:#f2d675;
    --text:#f7f1d0;
    --muted:#c9b06a;
  }
  body{
    background:#000;
    color:var(--text);
    font-family:'Play',system-ui,sans-serif;
    margin:0;
    min-height:100vh;
    display:grid;
    place-items:center;
  }
  .card{
    background:#0b0b0b;
    border:1px solid var(--border);
    padding:28px 24px;
    width:min(440px,92vw);
    border-radius:16px;
    box-shadow:0 0 18px rgba(214,180,76,.2),inset 0 0 0 1px rgba(214,180,76,.12);
    text-align:center;
  }

  /* Brand line (logo + text side by side) */
  .brand {
    display:flex;
    align-items:center;
    justify-content:center;
    gap:10px;
    margin-bottom:8px;
    border-bottom:1px solid var(--border);
    padding-bottom:8px;
  }
  .brand-logo {
    width:44px;
    height:44px;
    object-fit:contain;
    filter:drop-shadow(0 0 5px rgba(242,214,117,.35));
  }
  .brand h1 {
    color:var(--accent);
    margin:0;
    font-size:22px;
    font-weight:700;
  }

  .muted{color:var(--muted);font-size:14px;margin:10px 0 20px;}
  label{display:block;margin:10px 0 6px;text-align:left;color:var(--accent);}
  input{
    width:100%;
    padding:10px;
    border-radius:8px;
    border:1px solid var(--accent);
    background:#141414;
    color:#f7f1d0;
    font-family:'Play',sans-serif;
  }
  button{
    margin-top:18px;
    width:100%;
    padding:12px;
    border-radius:10px;
    border:1px solid var(--accent);
    background:#141414;
    color:#f7f1d0;
    font-weight:700;
    cursor:pointer;
    font-family:'Play',sans-serif;
    transition:background .15s ease, color .15s ease;
  }
  button:hover{background:var(--accent);color:#000;}
  .err{color:#ff9b9b;margin-top:12px;min-height:1em;}
  footer{margin-top:16px;color:var(--muted);font-size:12px;}
</style>
</head>
<body>

  <div class="card">
    <div class="brand">
      <img class="brand-logo"
           src="https://static.wixstatic.com/media/08ea88_820ac3bc561d4233ad73a7af859f28bf~mv2.png/v1/fill/w_66,h_66,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/0_New_JMBN_Logo_Gold.png"
           alt="JMBN Logo">
      <h1>JMBN Manifest</h1>
    </div>

    <p class="muted">Organization Access Portal</p>

    <label>Username</label>
    <input id="username" placeholder="e.g. ops" autocomplete="username" />
    <label>Password</label>
    <input id="password" type="password" placeholder="••••••••" autocomplete="current-password" />
    <button id="loginBtn">Sign in</button>

    <div id="msg" class="err"></div>
    <footer>Only authorized JMBN personnel may log in.</footer>
  </div>

  <!-- Supabase + Auth Logic -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="js/auth.js"></script>
  <script>
    // Auto-forward if already logged in
    (async () => {
      const session = await getSession();
      if (session) location.replace(BASE + "index.html");
    })();

    document.getElementById('loginBtn').addEventListener('click', async () => {
      const u = document.getElementById('username').value.trim();
      const p = document.getElementById('password').value;
      const msg = document.getElementById('msg');

      msg.textContent = "";
      const { error } = await signIn(u, p);
      if (error) {
        msg.textContent = error.message;
        return;
      }

      location.replace(BASE + "index.html");
    });
  </script>
</body>
</html>
